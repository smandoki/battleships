(()=>{"use strict";function t(e){const n=[];return e.forEach((e=>{Array.isArray(e)?n.push(t(e)):n.push(e)})),n}function e(t,e){return Math.floor(Math.random()*(e-t))+t}class n{#t=0;#e;constructor(t){this.#e=t}hit(){this.isSunk()||this.#t++}isSunk(){return this.#t===this.#e}getLength(){return this.#e}getHitCount(){return this.#t}}class s{#n={};#s;#i=0;constructor(){this.#s=function(t,e){const n=new Array(7);for(let t=0;t<7;t++)n[t]=new Array(7);return n}()}addShip(t,e,s,i){const r=new n(s);for(let n=0;n<s;n++)"row"===i?this.#s[t+n][e]=this.#i:this.#s[t][e+n]=this.#i;this.#n[this.#i++]=r}receiveAttack(t,e){void 0===this.#s[t][e]?this.#s[t][e]="miss":(this.#n[this.#s[t][e]].hit(),this.#s[t][e]="hit")}isValidPlacement(t,e,n,s){for(let i=0;i<n;i++)if("row"===s){if(!this.#r(t+i,e))return!1}else if(!this.#r(t,e+i))return!1;return!0}#r(t,e){return t>=0&&t<7&&e>=0&&e<7&&void 0===this.#s[t][e]}isAllShipsSunk(){if(0===Object.keys(this.#n).length)return!1;for(const[t,e]of Object.entries(this.#n))if(!e.isSunk())return!1;return!0}getBoard(){return t(this.#s)}getCell(t,e){return this.#s[t][e]}}const i=function(){const t=document.getElementById("root"),n=new s;let i;function r(t){}function o(t){return{y:Math.floor(t/7),x:t%7}}return{init:function(s){i=s,t.innerHTML="",function(t){const n=[2,3,3,4,5];for(;n.length>0;){const s=n.pop();let i,r,o;do{i=e(0,6),r=e(0,6),o=0===e(0,2)?"row":"col"}while(!t.isValidPlacement(i,r,s,o));t.addShip(i,r,s,o)}}(n);const l=document.createElement("div");l.setAttribute("id","gameboardPage");const c=document.createElement("div");c.classList.add("grid"),c.classList.add("player-grid"),c.style.gridTemplateColumns="repeat(7, 1fr)",c.style.gridTemplateRows="repeat(7, 1fr)";for(let t=0;t<49;t++){const t=document.createElement("div");t.classList.add("cell"),c.appendChild(t)}l.appendChild(c);const d=document.createElement("div");d.classList.add("grid"),d.classList.add("computer-grid"),d.style.gridTemplateColumns="repeat(7, 1fr)",d.style.gridTemplateRows="repeat(7, 1fr)";for(let t=0;t<49;t++){const t=document.createElement("div");t.classList.add("cell"),t.addEventListener("click",r),d.appendChild(t)}l.appendChild(d),t.appendChild(l),function(){const t=document.querySelectorAll(".player-grid .cell"),e=document.querySelectorAll(".computer-grid .cell");let s=0;for(const e of t){const{x:t,y:n}=o(s++),r=i.getCell(t,n);r>=0?e.classList.add("ship"):"hit"===r?e.classList.add("hit"):"miss"===r&&e.classList.add("miss")}s=0;for(const t of e){const{x:e,y:i}=o(s++),r=n.getCell(e,i);"hit"===r?t.classList.add("hit"):"miss"===r&&t.classList.add("miss")}}()}}}();(function(){const t=document.getElementById("root"),e=[2,3,3,4,5],n=["Place your carrier (length: 5)","Place your battleship (length: 4)","Place your cruiser (length: 3)","Place your submarine (length: 3)","Place your destroyer (length: 2)"],r=new s;let o="row",l=e.pop();function c(t){o="row"===o?"col":"row",t.target.innerText="row"===o?"Axis: row":"Axis: column"}function d(t){const s=t.target.dataset.index,{x:c,y:d}=h(s);r.isValidPlacement(c,d,l,o)&&(r.addShip(c,d,l,o),u(c,d,"ship",o,l),0!=n.length?(document.querySelector("h2").innerText=n.shift(),l=e.pop()):i.init(r))}function a(t){const e=t.target.dataset.index,n=document.querySelectorAll(".cell");for(const t of n)t.classList.remove("shipPlaceholder");const{x:s,y:i}=h(e);r.isValidPlacement(s,i,l,o)&&u(s,i,"shipPlaceholder",o,l)}function u(t,e,n,s,i){const r=document.querySelectorAll(".cell");for(let o=0;o<i;o++){let i;i="row"===s?p(t+o,e):p(t,e+o),r[i].classList.add(n)}}function h(t){return{y:Math.floor(t/7),x:t%7}}function p(t,e){return 7*e+t}return{init:function(){const e=document.createElement("div");e.setAttribute("id","shipPlacementPage");const s=document.createElement("h2");s.innerText=n.shift(),e.appendChild(s);const i=document.createElement("button");i.innerText="Axis: row",i.addEventListener("click",c),e.append(i);const r=document.createElement("div");r.classList.add("grid"),r.style.gridTemplateColumns="repeat(7, 1fr)",r.style.gridTemplateRows="repeat(7, 1fr)";for(let t=0;t<49;t++){const e=document.createElement("div");e.classList.add("cell"),e.dataset.index=t,e.addEventListener("mouseover",a),e.addEventListener("click",d),r.appendChild(e)}e.appendChild(r),t.appendChild(e)}}})().init()})();